var latitud="";$(document).ready(function(){var latd="";$('#img2').hide();function geoloc(){d=document.getElementById("demo");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(showPosition,showError)
return!0}else{d.innerHTML="<p>Lo sentimos, tu dispositivo no admite la geolocaización.</p>";return!1}}
function storage(){var destino="funciones/selector/selectorMac.php";$.ajax({url:destino,type:'POST',contentType:!1,processData:!1,cache:!1,success:function(response){var usuarios=JSON.parse(response);var full_address=usuarios.full_address},error:function(){}});const aValue=localStorage.getItem('variable1');if(aValue!=null){var inputstorage=document.getElementById("storagel");inputstorage.value=aValue}else{let aleatorio=Math.round(Math.random()*1000000);let p="12345mm"+aleatorio;var inputstorage=document.getElementById("storagel");localStorage.setItem('variable1',p);inputstorage.value=p}}
function showPosition(position){latitud=position.coords.latitude;$("#ubilat").val(latitud);longitud=position.coords.longitude;$("#ubilatm").text(longitud);console.log($("#ubilat").val());$("#ubilatm").text("LATITUD LISTA!");$("#ubilon").val(longitud);if(latitud!=""){$('#img2').show();$('#startbtn img').hide();alertify.set("notifier","position","top-right");alertify.notify("UBICACIÓN LISTO!!","success",2,function(){})}
$('#img2').show();$("#ubilonm").text("LONGITUD LISTO!")}
function showError(error){switch(error.code){case error.PERMISSION_DENIED:d.innerHTML+="<p>El usuario ha denegado el permiso a la localización.</p>"
break;case error.POSITION_UNAVAILABLE:d.innerHTML+="<p>La información de la localización no está disponible.</p>"
break;case error.TIMEOUT:d.innerHTML+="<p>El tiempo de espera para buscar la localización ha expirado.</p>"
break;case error.UNKNOWN_ERROR:d.innerHTML+="<p>Ha ocurrido un error desconocido.</p>"
break}}
var qrcode=new QRCode("outputbox");function makeCode(){input="https://servicios.deporte.gob.ec/rrhh/ingreso";qrcode.makeCode(input)}
makeCode();var calcularEstados=function(parametro1,parametro2){$(parametro1).click(function(e){$(parametro2).val($(this).attr('etiqueta'));$(".tipo__de__timbrada").text("TIMBRADA DE "+$(this).attr('etiqueta'));$('#startbtn img').hide();var inputF=document.getElementById("msg2");var inputFm=document.getElementById("msg2m");geoloc();storage();control=setInterval(cronometro,10)})}
var centesimas=0;var segundos=0;var minutos=0;var horas=0;function cronometro(){if(centesimas<99){centesimas++;if(centesimas<10){centesimas="0"+centesimas}}
if(centesimas==99){centesimas=-1}
if(centesimas==0){segundos ++;if(segundos<10){segundos="0"+segundos}
$("#segundosRestar").val(segundos)}
if(segundos==59){segundos=-1}
if((centesimas==0)&&(segundos==0)){minutos++;if(minutos<10){minutos="0"+minutos}
$("#minutosRestar").val(minutos)}
if(minutos==59){minutos=-1}
if((centesimas==0)&&(segundos==0)&&(minutos==0)){horas ++;if(horas<10){horas="0"+horas}
$("#horasRestar").val(horas)}}
calcularEstados($("#ingresoCalculas"),$("#etiquetaMostrar"));calcularEstados($("#salidaAlmuerzo"),$("#etiquetaMostrar"));calcularEstados($("#regresoAlmuerzo"),$("#etiquetaMostrar"));calcularEstados($("#salidaSecretaria"),$("#etiquetaMostrar"));$('#btn2').click(function(){$('#main').animate({'left':'-100%'});$('#btn1').removeClass('active');$('#btn2').addClass('active')});$('#btn1').click(function(){$('#main').animate({'left':'0%'});$('#btn2').removeClass('active');$('#btn1').addClass('active')});$('#stopbtn').click(function(){$('#startbtn img').show();$('#stopbtn').hide();$('#img2').hide();var videoEl=document.getElementById('preview')});$("#save").click(function(e){e.preventDefault();var valores=$("#ingresar").val();var caja=$(".contenido");caja.append("<p>"+valores+"</p>")});$('#ingresar').on('click',function(e){var paqueteDeDatos=new FormData();var msg2=$("#msg2").val();var ubilat=$("#ubilat").val();var ubilon=$("#ubilon").val();var storagel=$("#storagel").val();var horaFinal=$("#horasRestar").val()+":"+$("#minutosRestar").val()+":"+$("#segundosRestar").val();var horaTotales=$("#horasRestar").val();var minutosTotales=$("#minutosRestar").val();var segundosTotales=$("#segundosRestar").val();if(ubilat==""||ubilon==""){alertify.set("notifier","position","top-right");alertify.notify("Es obligatorio calcular longitud y latitud","error",2,function(){})}else{$("#ingresar").hide();$(".git__registro").html('<img src="images/reloadGit.webp" style="height:35px; margin-left: .5em; border-radius: .5em; cursor: pointer;">');paqueteDeDatos.append('msg2',msg2);paqueteDeDatos.append('ubilat',ubilat);paqueteDeDatos.append('ubilon',ubilon);paqueteDeDatos.append('storagel',storagel);paqueteDeDatos.append('horaTotales',horaTotales);paqueteDeDatos.append('minutosTotales',minutosTotales);paqueteDeDatos.append('segundosTotales',segundosTotales);paqueteDeDatos.append('horaFinal',horaFinal);var etiquetaMostrar=$("#etiquetaMostrar").val();paqueteDeDatos.append('etiquetaMostrar',etiquetaMostrar);var destino="funciones/funcionesInserta/ingresarFecha.php";$.ajax({url:destino,type:'POST',contentType:!1,data:paqueteDeDatos,processData:!1,cache:!1,success:function(response){var elementos=JSON.parse(response);var mensaje=elementos.mensaje;var varlt=elementos.varlt;var varlg=elementos.varlg;if(mensaje==1){alertify.set("notifier","position","top-right");alertify.notify("NO CONECTADO A LA BASE","error",5,function(){});$("#ingresar").show();$(".git__registro").html('')}else if(mensaje==2){alertify.set("notifier","position","top-right");alertify.notify("Faltan datos, no hemos podido registrar tu asistencia. Prueba de nuevo.","error",5,function(){});$("#ingresar").show();$(".git__registro").html('')}else if(mensaje==3){alertify.set("notifier","position","top-right");alertify.notify("Registro no autorizado: Es posible que- "+varlt+" -y- "+varlg+" - del establecimiento","error",10000,function(){});window.setTimeout(function(){location.reload()},10000)}else if(mensaje==5){alertify.set("notifier","position","top-right");alertify.notify("Registro no autorizado: El dispositivo móvil no corresponde a este usuario","error",5,function(){});window.setTimeout(function(){location.reload()},5000)}else if(mensaje==105){alertify.set("notifier","position","top-right");alertify.notify("Aún no existen horarios para su dirección o persona. Comunicarse con talento humano solicitando registro de horarios.","error",5,function(){});window.setTimeout(function(){location.reload()},9000)}else if(mensaje==108){alertify.set("notifier","position","top-right");alertify.notify("Registro no autorizado: Ya ingreso este tipo de timbrada para el día de hoy","error",5,function(){});window.setTimeout(function(){location.reload()},5000)}else{alertify.set("notifier","position","top-right");alertify.notify("Registro de asistencia exitoso. Sus coordenadas son:"+varlt+"   "+varlg,"success",10,function(){});window.setTimeout(function(){location.reload()},10000)}},error:function(){}})}});$(".mensaje__movil__escritorio").hide();if($("#habilitantes").val()=="A"){$("#box2").show();$("#box1").hide();$(".box2").removeAttr('style');$(".box2").attr('style','display:block;background:#ffbb00;width:100%; display:flex; flex-direction:column; align-items:center; justify-content:center;');$("#ingresar").attr('style','background: #1a1a1a;color: white;border-radius: 30px;width: 200px;font-size: 12px;padding:1em; margin-bottom:2em;');$(".nombre__completo").attr('style','color: white;font-weight: bold;font-size: 35px;margin-bottom:2em;margin-top:2em;');$("#ubilatm").attr('style','font-family: arial;color:white; font-size: 20px;');$("#ubilonm").attr('style','font-family: arial;color:white; font-size: 20px;');if($(window).width()<=800){$(".mensaje__movil__escritorio").show();$("#box2").hide()}else{$(".mensaje__movil__escritorio").hide();$("#box2").show()}}})